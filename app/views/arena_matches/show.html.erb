<section>
  <header>
    <h1>Arena Match #<%= @arena_match.id %></h1>
    <p>Status: <%= @arena_match.status.humanize %></p>
    <% if @arena_match.spectator_code.present? %>
      <p>Spectator Code: <code><%= @arena_match.spectator_code %></code></p>
    <% end %>
    <p class="text-xs text-slate-500" data-controller="moderation-guideline" data-action="mouseenter->moderation-guideline#show mouseleave->moderation-guideline#hide" data-guideline="griefing">
      Arena chat monitored. Hover for guidelines.
      <span data-moderation-guideline-target="tooltip" class="hidden"></span>
    </p>
  </header>

  <section>
    <h2>Participants</h2>
    <table>
      <thead>
        <tr>
          <th>Team</th>
          <th>Character</th>
          <th>Result</th>
        </tr>
      </thead>
      <tbody>
        <% @participations.each do |participation| %>
          <tr>
            <td><%= participation.team.capitalize %></td>
            <td><%= participation.character.name %></td>
            <td><%= participation.result.humanize %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </section>

  <% if @arena_match.metadata["twitch_channel"].present? %>
    <section class="mt-4">
      <h2>Streamer View</h2>
      <iframe
        src="https://player.twitch.tv/?channel=<%= @arena_match.metadata["twitch_channel"] %>&parent=<%= request.host %>"
        height="240"
        width="100%"
        allowfullscreen>
      </iframe>
    </section>
  <% end %>

  <section>
    <h2>Spectator Controls</h2>
    <%= button_to "Spectate via Turbo stream", spectate_arena_match_path(@arena_match), method: :post, class: "button" %>
    <div data-controller="arena-spectator" data-arena-spectator-match-id-value="<%= @arena_match.id %>">
      <h3>Live Feed</h3>
      <ul data-arena-spectator-target="log" class="timeline"></ul>
    </div>
  </section>
</section>

